Loading required package: tidyverse
── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.5.1
✔ ggplot2   4.0.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
Loading required package: fastcluster

Attaching package: ‘fastcluster’

The following object is masked from ‘package:stats’:

    hclust

Loading required package: latex2exp
Loading required package: grid
Loading required package: gridExtra

Attaching package: ‘gridExtra’

The following object is masked from ‘package:dplyr’:

    combine

  tidyverse fastcluster   latex2exp        grid   gridExtra 
       TRUE        TRUE        TRUE        TRUE        TRUE 
list()
Loading required package: bigstatsr
Loading required package: bigsnpr
bigstatsr   bigsnpr 
     TRUE      TRUE 

----------------------------------------------------------------------------------------------------
Partitioning variants
----------------------------------------------------------------------------------------------------

Processing chromosome 18 ...

Mean group sizes: 
   res_7    res_6    res_5    res_4    res_3    res_2    res_1 
 1.00000  3.54470  7.21990 10.38054 15.50427 29.14056 52.96350 
Partitions written to: /nobackup/proj/comet_kogwas/data/tmp/partitions/chr18.txt

----------------------------------------------------------------------------------------------------
Generating knockoffs
----------------------------------------------------------------------------------------------------
	+----------------------+
	|                      |
	|  SNPKNOCK2, v0.3     |
	|  July 21, 2020       |
	|  Matteo Sesia        |
	|                      |
	+----------------------+

Copyright (C) 2020 Stanford University.
Distributed under the GNU GPLv3 open source license.

Use --help for more information.

Command line arguments:
  --bgen /nobackup/proj/comet_kogwas/data/Nicola_chr{18:18}
  --keep /nobackup/proj/comet_kogwas/data/Nicola_qc_samples.txt
  --extract /nobackup/proj/comet_kogwas/data/Nicola_qc_chr{18:18}.txt
  --map /nobackup/proj/comet_kogwas/data/Nicola_map_chr{18:18}.txt
  --part /nobackup/proj/comet_kogwas/data/tmp/partitions/chr{18:18}.txt
  --ibd /nobackup/proj/comet_kogwas/data/Nicola_ibd_chr{18:18}.txt
  --K 10
  --cluster_size_min 1000
  --cluster_size_max 10000
  --hmm-rho 1
  --hmm-lambda 1e-3
  --windows 0
  --n_threads 4
  --seed 2020
  --compute-references
  --generate-knockoffs
  --out /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr{18:18}

Requested operations:
  --compute-references
  --generate_knockoffs


--------------------------------------------------------------------------------
Loading metadata
--------------------------------------------------------------------------------
Loading sample information from:
  /nobackup/proj/comet_kogwas/data/Nicola_chr18.sample
Loading legend from:
  /nobackup/proj/comet_kogwas/data/Nicola_chr18.bim
Loading partitions from:
  /nobackup/proj/comet_kogwas/data/tmp/partitions/chr18.txt
Loading IBD segments from:
  /nobackup/proj/comet_kogwas/data/Nicola_ibd_chr18.txt
Loaded 13654 IBD segments.

Printing summary of 1 windows:
     0: 0--7256
Summary of metadata for chromosome 1:
  number of samples (after | before filtering) : 24510 | 24510
  number of SNPs (after | before filtering)    : 7256 | 7256
  number of variant partitions                 : 7
  size of genomic windows                      : whole-chromosome
  number of IBD segments                       : 13654


--------------------------------------------------------------------------------
Kinship (using only haplotype data)
--------------------------------------------------------------------------------
Reached 1
Chromosome 1 will be loaded from:
  haplotype file            : /nobackup/proj/comet_kogwas/data/Nicola_chr18.bgen
  sample file               : /nobackup/proj/comet_kogwas/data/Nicola_chr18.sample
  legend file               : /nobackup/proj/comet_kogwas/data/Nicola_chr18.bim
  thinning factor           : 10
  sample filter file        : /nobackup/proj/comet_kogwas/data/Nicola_qc_samples.txt
  variant filter file       : /nobackup/proj/comet_kogwas/data/Nicola_qc_chr18.txt
  number of SNPs            : 726
  number of haplotypes      : 49020

Reading BGEN file using 4 threads:
|....................................................................................................|
|====================================================================================================|
Solving 1 bifurcating K-means problems using 1 threads.

Bifurcating K-means
Smallest allowed cluster size: 1000
 step	 cluster	    size	    left	   right	accepted
    1	       0	   49020	   20156	   28864	     yes	
    2	       0	   20156	   10146	   10010	     yes	
    3	       0	   10146	    4526	    5620	     yes	
    5	       1	   28864	   15070	   13794	     yes	
    6	       1	   15070	    7422	    7648	     yes	
    8	       2	   10010	    5018	    4992	     yes	
   11	       4	   13794	    6246	    7548	     yes	
Bifurcating K-means completed after 14 steps.
Number of clusters: 8.


Kinship clusters written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_clust.txt
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18.sample

Assigning references for the whole chromosome using 4 threads: 
|....................................................................................................|
|====================================================================================================|

Reached 2
Individual global references written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_lref.txt

Individual local references written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_ref.txt


--------------------------------------------------------------------------------
Knockoffs for chromosome 1
--------------------------------------------------------------------------------
Chromosome 1 will be loaded from:
  haplotype file            : /nobackup/proj/comet_kogwas/data/Nicola_chr18
  haplotype file format     : bgen
  sample file               : /nobackup/proj/comet_kogwas/data/Nicola_chr18.sample
  legend file               : /nobackup/proj/comet_kogwas/data/Nicola_chr18.bim
  map file                  : /nobackup/proj/comet_kogwas/data/Nicola_map_chr18.txt
  sample filter file        : /nobackup/proj/comet_kogwas/data/Nicola_qc_samples.txt
  variant filter file       : /nobackup/proj/comet_kogwas/data/Nicola_qc_chr18.txt
  number of SNPs            : 7256
  number of windows         : 1
  number of haplotypes      : 49020

Loading data for chromosome 1
Reading BGEN file using 4 threads:
|....................................................................................................|
|====================================================================================================|

Initializing HMM with user-supplied hyperparameters: rho = 1, lambda = 0.001.

HMM parameters written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_hmm.txt

SNP groups written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res0_grp.txt
SNP windows written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res0_windows.txt

Generating related knockoffs for chromosome 1 (16394 haplotypes in 4780 families, 7256 variants in 7256 groups):
|....................................................................................................|
|====================================================================================================|

Generating unrelated knockoffs for chromosome 1 (32626 haplotypes; 7256 variants in 7256 groups):
|....................................................................................................|
|====================================================================================================|


Output (binary) written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res0.bed
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res0.bim
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res0.fam
Reconstructed ancestries written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res0_anc.txt
SNP groups written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res1_grp.txt
SNP windows written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res1_windows.txt

Generating related knockoffs for chromosome 1 (16394 haplotypes in 4780 families, 7256 variants in 2047 groups):
|....................................................................................................|
|====================================================================================================|

Generating unrelated knockoffs for chromosome 1 (32626 haplotypes; 7256 variants in 2047 groups):
|....................................................................................................|
|====================================================================================================|


Output (binary) written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res1.bed
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res1.bim
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res1.fam
Reconstructed ancestries written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res1_anc.txt
SNP groups written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res2_grp.txt
SNP windows written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res2_windows.txt

Generating related knockoffs for chromosome 1 (16394 haplotypes in 4780 families, 7256 variants in 1005 groups):
|....................................................................................................|
|====================================================================================================|

Generating unrelated knockoffs for chromosome 1 (32626 haplotypes; 7256 variants in 1005 groups):
|....................................................................................................|
|====================================================================================================|


Output (binary) written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res2.bed
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res2.bim
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res2.fam
Reconstructed ancestries written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res2_anc.txt
SNP groups written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res3_grp.txt
SNP windows written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res3_windows.txt

Generating related knockoffs for chromosome 1 (16394 haplotypes in 4780 families, 7256 variants in 699 groups):
|....................................................................................................|
|====================================================================================================|

Generating unrelated knockoffs for chromosome 1 (32626 haplotypes; 7256 variants in 699 groups):
|....................................................................................................|
|====================================================================================================|


Output (binary) written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res3.bed
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res3.bim
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res3.fam
Reconstructed ancestries written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res3_anc.txt
SNP groups written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res4_grp.txt
SNP windows written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res4_windows.txt

Generating related knockoffs for chromosome 1 (16394 haplotypes in 4780 families, 7256 variants in 468 groups):
|....................................................................................................|
|====================================================================================================|

Generating unrelated knockoffs for chromosome 1 (32626 haplotypes; 7256 variants in 468 groups):
|....................................................................................................|
|====================================================================================================|


Output (binary) written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res4.bed
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res4.bim
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res4.fam
Reconstructed ancestries written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res4_anc.txt
SNP groups written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res5_grp.txt
SNP windows written to:
  /nobackup/proj/comet_kogwas/data/tmp/knockoffs/knockoffs_chr18_res5_windows.txt

Generating related knockoffs for chromosome 1 (16394 haplotypes in 4780 families, 7256 variants in 249 groups):
|....................................................................................................|
|==================================================